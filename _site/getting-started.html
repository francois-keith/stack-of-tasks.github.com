<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Getting Started</title>

    <!-- Bootstrap -->
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <!-- Jekyll Syntax Highlighting -->
    <link href="syntax.css" rel="stylesheet">

    <!-- Website specific stylesheet -->
    <link href="style.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
	<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
	<![endif]-->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

    
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript"
	    src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    
    <!-- highlight.js -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/styles/github.min.css" rel="stylesheet">
    <script type="text/javascript"
	    src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/highlight.min.js">
    </script>
    <script>hljs.initHighlightingOnLoad();</script>
    

    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-34448532-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

    </script>

    <script type="text/javascript" src="/js/oauth.min.js"></script>

    <!-- favicons generated with http://realfavicongenerator.net -->
    <link rel="shortcut icon" href="/assets/favicons/favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/favicons/apple-touch-icon-152x152.png">
    <link rel="icon" type="image/png" href="/assets/favicons/favicon-196x196.png" sizes="196x196">
    <link rel="icon" type="image/png" href="/assets/favicons/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/assets/favicons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/assets/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/assets/favicons/favicon-32x32.png" sizes="32x32">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-TileImage" content="/assets/favicons/mstile-144x144.png">
    <meta name="msapplication-square70x70logo" content="/assets/favicons/mstile-70x70.png">
    <meta name="msapplication-square144x144logo" content="/assets/favicons/mstile-144x144.png">
    <meta name="msapplication-square150x150logo" content="/assets/favicons/mstile-150x150.png">
    <meta name="msapplication-square310x310logo" content="/assets/favicons/mstile-310x310.png">
    <meta name="msapplication-wide310x150logo" content="/assets/favicons/mstile-310x150.png">

    <meta property="og:type" content="website">
    <meta property="og:title" content="Getting Started">
    <meta property="og:site_name" content="RobOptim">
    <meta property="og:description" content="RobOptim: Numerical Optimization for Robotics">
    <meta property="og:url" content="http://www.roboptim.net/">
    <meta property="og:locale" content="en_US">

    <meta property="fb:page_id" content="234139373456687">
    <meta property="fb:admins" content="719767467" />

  </head>
  <body>
      <div class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">RobOptim</a>
          </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
	      
<li><a href="/download.html"><span class='glyphicon glyphicon-download'></span> Download</a></li>


	      <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-book"></span>
		  Documentation <b class="caret"></b></a>
		<ul class="dropdown-menu">
		  <li class="dropdown-header">RobOptim Features</li>
		  
<li><a href="/showcase.html">Showcase</a></li>


		  
<li><a href="/solvers.html">Solvers</a></li>


		  
<li><a href="/benchmark.html">Benchmark</a></li>


		  
<li><a href="/faq.html">FAQ</a></li>


		  <li class="divider"></li>
		  <li class="dropdown-header">RobOptim Core</li>
		  
<li class="active"><a href="/getting-started.html" class="active">Getting Started</a></li>


		  <li class="divider"></li>
		  
<li><a href="/documentation.html">API Documentation</a></li>


		</ul>
	      </li>

	      <li class="dropdown">
		<a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-wrench"></span>
		  Development <b class="caret"></b></a>
		<ul class="dropdown-menu">
		  
<li><a href="/development.html">Development Dashboard</a></li>


		  <li class="divider"></li>
		  <li><a href="http://www.github.com/roboptim/">View on GitHub</a></li>
		</ul>
	      </li>

              <li><a href="https://groups.google.com/forum/#!forum/roboptim">
		  <span class="glyphicon glyphicon-question-sign"></span> Support</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container-fluid -->
      </div>

      <div class="container">
	<h1 id="getting-started" class="page-header">Getting Started</h1>

<h2>Example</h2>


	In this section are detailed some examples to test the stack of tasks framework 
on the humanoid robot <a href="">Romeo</a>.   


To vizualize the robot, you can use <code>rviz</code>.


        <h3>Running the python scripts</h3>

To execute the scripts and display the results with rviz, you need 2 consoles.</br>

In the first, start the viewer.
<pre><code>$ roslaunch romeo_description sot_display.launch</code></pre>
Note: if you do not want to use the viewer, you can only start <code>roscore</code>.</br>

In the second, start the python script.   
<pre><code>$ ipython -i kine_romeo.py</code></pre>

<h3>Detail of the python scripts</h3>

<p>
Those scripts are located in <code>${your_installation_path}/lib/python2.X/site-packages/dynamic_graph/tutorial.</code>
With the installation script, the installation path is <code>${HOME}/devel/INSTALLATION_FOLDER/install</code>,
where <code>INSTALLATION_FOLDER</code> is the folder specified in the istallation.

python2.X is your version of python version: 2.6 or 2.7
</p>

To run them, it is necessary to complete the environment variables LD_LIBRARY_PATH and PYTHONPATH.
To this purpose, you can either
<ol>
<li> source the file <code>config_XXX.bash</code> created during the compilation using the install-sot.sh script.
This file is located in the same folder as install_sot.sh.
</li>
<li>
or you can do it manually:
<pre><code>export your_installation_path=${HOME}/devel/INSTALLATION_FOLDER/install
export ROS_PACKAGE_PATH=${your_installation_path}/../:$ROS_PACKAGE_PATH;
export LD_LIBRARY_PATH=${your_installation_path}/lib/:$LD_LIBRARY_PATH;
export LD_LIBRARY_PATH=${your_installation_path}/lib/plugin:$LD_LIBRARY_PATH;
export PYTHONPATH=${your_installation_path}/lib/python2.X/site-packages/:$PYTHONPATH
</code></pre>
</li>
<ol>
        <h3>kine_romeo.py</h3>

This script defines a first kinematic simulation with the Romeo robot.
The romeo robot is controlled by 4 tasks: 
<ul>
<li>
Two contact tasks on the feet, _contactRF_ and _contactLF_, corresponding to two 6d position tasks.
</li>
<li>
A task controlling the center of mass   
</li>
This task is one of the several tasks predefined (but not added to the stack) in the dictionary of tasks provided by the entity _Robot_.  
The dictionary can be consulted using the command: <code>robot.tasks</code>
<li>A 3d position task for the right hand</li>
</ul>

<p>
This task is characterized by 4 entities: the task, the operational point (here the right hand augmented by a translation), the desired position for the hand (here only 3d are defined) and the gain of the task (an adaptive gain).   
All those elements are gathered in a structure called _taskRH_,instance of _MetaTask6d_, that realizes all the links between the several entities.  
</p>

<p>
In the script, only the position of the hand is controlled. To change the degrees of freedom controlled, please change the value of the signal selec.
This signal is a sequence of boolean in this order: psi, theta, phi, z, y, x (reverse polish notation). For example:
</p>

<pre><code>taskRH.feature.selec.value = '111111' # The task is controlled in position and orientation.
taskRH.feature.selec.value = '000111' # The task is then controlled in position only
</code></pre>

<p>
The definition of this task does not use the predefined version of the task contained in the dictionary, only to present an example of task creation.

Typing <code>go</code>starts a the simulation loop.
The robot will then go to the desired positions defined by the tasks. 
You can change interactively the content of the stack, the hand... using the python interface.
</p>

<p>
To continue the example, you can for example try adding a task on the left hand, following the same scheme as for the right hand.
</p>

        <h3>walk_romeo.py</h3>

In this example, the Romeo robot goes for a (kinematic) walk.
This script uses the jrl-walkgen package to compute the required postures for the feet, the center of mass and the waist orientation.

The stack contains the following tasks (by order of decreasing priority)
<ol>
<li> ROMEO_task_com, that forces the Center of mass of the robot to be in the support polygon (only the x and y axes are constrained). You can access it using <code>robot.tasks['com']</code>.</li>
<li> taskWaist, that constrains the rotation and translation of the waist in a plane. You can access it using <code>robot.tasks['waist']</code>.</li>
<li> ROMEO_task_right-ankle, that defines the 6 dof position of the right Foot</li>
<li> ROMEO_task_left-ankle, that defines the 6 dof position of the left Foot</li>
</ol>

    

In addition to those tasks (that translate the output of the pattern generator into tasks), another task is defined: <code>robot.tasks['robot_task_position']</code>, to force the arms, head and chest to stay still during the walk
<p>
You can control the walk of the robot with the following command:
<code>robot.pg.velocitydes.value = (x, y, theta)</code>
<ol>
<li> x is the forward/backward velocity</li>
<li> y is the lateral velocity</li>
<li> theta is the rotation velocity (requires that ||(x,y)|| > 0.01)</li>
</ol>
</p>

        <h3>sot-concept.py: understanding the stack of task mechanism</h3>


This script aims at understanding the mechanisms of a hierarchy of task.

<p>In this script, the robot Romeo has to grasp a ball. 
Several sets of stack are tested in order to exemplify the influence and necessity of elements/tasks 
such as com control, joint limits, damping... during the realization of a simple motion.
</p>

<p>
The purpose of this script is to see by the example the possible faulty behaviors that 
can appear (divergence, loss of stability ...) when the stack is incomplete.
</p>

<ol>
<li> Only the task RH</br>
Since there is no constraint on the feet, the robot flies to the objective
</li>

<li> Task RH + foot constraint, balance is kept</br>
The robot put its hand at the desired place while keeping its feet on the ground
</li>

<li> Task RH + foot constraint, balance is lost</br>   
The robot put its hand at the desired place while keeping its feet on the ground, but the balance of the robot is lost due to the desired position of the hand
</li>

<li> Task RH + foot constraint + COM=</br>
The robot put its hand at the desired place while keeping its feet on the ground and its balance, but enters in self collision during its motion
</li>

<li> Task RH + foot constraint + COM= + JL</br>
The self collision is solved by adding a artificial joint limit.
</li>

<li> Task RH + foot constraint + COM<   </li>


<li> Task RH + foot constraint + COM= + SINGULARITY</br>
The robot put its hand at the desired place. 
Due to the motion of the ball (type <code>i</code> to move it), the robot goes into a near singular configuration and the control law reaches high values, causing a strange behavior of the robot.
</li>

<li>Task RH + foot constraint + COM= + SINGULARITE + DAMPING</br>
In this case, some damping is added to prevent high control values.
</li>
</ol>
Note: you can change the configuration by re-typing <code>menu()</code>

<h3>Diving into the python commands</h3>

A cheatsheet of the python commands available for entity and signal manipulation is 
<a href="http://db.tt/dODiGhlN">there</a>.



<h2>Tutorial</h2>

<p>
  A tutorial with exercises is also <a href="https://github.com/roboptim/roboptim-tutorial">available on GitHub</a>.
</p>

<div style="padding: 2em"></div>

      </div> <!-- /container -->

      
      <div class="container"><div id="disqus_thread"></div></div>
 <script type="text/javascript">
   var disqus_shortname = 'roboptim';
   var disqus_identifier = 'getting-started.html';
   var disqus_title = 'Getting Started';
   var disqus_url = 'http://roboptim.net/getting-started.html';
   (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      

      <div class="container">
	<!-- FOOTER -->
	<footer>
          <p class="pull-right"><a href="#">Back to top</a></p>
          <p>&copy; 2014 <a href="authors.html">RobOptim Team</a> &middot; <a href="http://www.github.com/roboptim">GitHub</a>
	    &middot; <a href="http://www.github.com/roboptim/roboptim.github.com">Fork this website</a>
	  </p>
      </footer>
      </div> <!-- /container -->
  </body>
</html>
